#[test] fn test__pattern_1() { let code = [0x48, 0xb8]; let mut full_code = code.to_vec(); full_code.extend_from_slice(&ALIGNED_ADDR.to_le_bytes()); full_code.extend_from_slice(&[0x48, 0xbb]); full_code.extend_from_slice(&ALIGNED_ADDR2.to_le_bytes()); full_code.extend_from_slice(&[0x0f, 0x28, 0x00, 0x0f, 0x28, 0x0b, 0x0f, 0x54, 0xc1, 0xf4]); let (mut vcpu, mem) = setup_vm(&full_code, None); mem.write_slice(&[0x11, 0x22, 0x33, 0x44, 0x55, 0x66, 0x77, 0x88, 0x99, 0xAA, 0xBB, 0xCC, 0xDD, 0xEE, 0xFF, 0x00], GuestAddress(ALIGNED_ADDR)).unwrap(); mem.write_slice(&[0xFF, 0xEE, 0xDD, 0xCC, 0xBB, 0xAA, 0x99, 0x88, 0x77, 0x66, 0x55, 0x44, 0x33, 0x22, 0x11, 0x00], GuestAddress(ALIGNED_ADDR2)).unwrap(); run_until_hlt(&mut vcpu).unwrap(); }
#[test] fn test__pattern_1() { let code = [0x48, 0xb8]; let mut full_code = code.to_vec(); full_code.extend_from_slice(&ALIGNED_ADDR.to_le_bytes()); full_code.extend_from_slice(&[0x48, 0xbb]); full_code.extend_from_slice(&ALIGNED_ADDR2.to_le_bytes()); full_code.extend_from_slice(&[0x66, 0x0f, 0x28, 0x00, 0x66, 0x0f, 0x28, 0x0b, 0x66, 0x0f, 0x54, 0xc1, 0xf4]); let (mut vcpu, mem) = setup_vm(&full_code, None); mem.write_slice(&[0x11, 0x22, 0x33, 0x44, 0x55, 0x66, 0x77, 0x88, 0x99, 0xAA, 0xBB, 0xCC, 0xDD, 0xEE, 0xFF, 0x00], GuestAddress(ALIGNED_ADDR)).unwrap(); mem.write_slice(&[0xFF, 0xEE, 0xDD, 0xCC, 0xBB, 0xAA, 0x99, 0x88, 0x77, 0x66, 0x55, 0x44, 0x33, 0x22, 0x11, 0x00], GuestAddress(ALIGNED_ADDR2)).unwrap(); run_until_hlt(&mut vcpu).unwrap(); }
#[test] fn test__pattern_2() { let code = [0x48, 0xb8]; let mut full_code = code.to_vec(); full_code.extend_from_slice(&ALIGNED_ADDR.to_le_bytes()); full_code.extend_from_slice(&[0x48, 0xbb]); full_code.extend_from_slice(&ALIGNED_ADDR2.to_le_bytes()); full_code.extend_from_slice(&[0x0f, 0x28, 0x00, 0x0f, 0x28, 0x0b, 0x0f, 0x54, 0xc1, 0xf4]); let (mut vcpu, mem) = setup_vm(&full_code, None); mem.write_slice(&[0x01; 16], GuestAddress(ALIGNED_ADDR)).unwrap(); mem.write_slice(&[0x01; 16], GuestAddress(ALIGNED_ADDR2)).unwrap(); run_until_hlt(&mut vcpu).unwrap(); }
#[test] fn test__pattern_2() { let code = [0x48, 0xb8]; let mut full_code = code.to_vec(); full_code.extend_from_slice(&ALIGNED_ADDR.to_le_bytes()); full_code.extend_from_slice(&[0x48, 0xbb]); full_code.extend_from_slice(&ALIGNED_ADDR2.to_le_bytes()); full_code.extend_from_slice(&[0x66, 0x0f, 0x28, 0x00, 0x66, 0x0f, 0x28, 0x0b, 0x66, 0x0f, 0x54, 0xc1, 0xf4]); let (mut vcpu, mem) = setup_vm(&full_code, None); mem.write_slice(&[0x01; 16], GuestAddress(ALIGNED_ADDR)).unwrap(); mem.write_slice(&[0x01; 16], GuestAddress(ALIGNED_ADDR2)).unwrap(); run_until_hlt(&mut vcpu).unwrap(); }
#[test] fn test__pattern_3() { let code = [0x48, 0xb8]; let mut full_code = code.to_vec(); full_code.extend_from_slice(&ALIGNED_ADDR.to_le_bytes()); full_code.extend_from_slice(&[0x48, 0xbb]); full_code.extend_from_slice(&ALIGNED_ADDR2.to_le_bytes()); full_code.extend_from_slice(&[0x0f, 0x28, 0x00, 0x0f, 0x28, 0x0b, 0x0f, 0x54, 0xc1, 0xf4]); let (mut vcpu, mem) = setup_vm(&full_code, None); mem.write_slice(&[0x80; 16], GuestAddress(ALIGNED_ADDR)).unwrap(); mem.write_slice(&[0x80; 16], GuestAddress(ALIGNED_ADDR2)).unwrap(); run_until_hlt(&mut vcpu).unwrap(); }
#[test] fn test__pattern_3() { let code = [0x48, 0xb8]; let mut full_code = code.to_vec(); full_code.extend_from_slice(&ALIGNED_ADDR.to_le_bytes()); full_code.extend_from_slice(&[0x48, 0xbb]); full_code.extend_from_slice(&ALIGNED_ADDR2.to_le_bytes()); full_code.extend_from_slice(&[0x66, 0x0f, 0x28, 0x00, 0x66, 0x0f, 0x28, 0x0b, 0x66, 0x0f, 0x54, 0xc1, 0xf4]); let (mut vcpu, mem) = setup_vm(&full_code, None); mem.write_slice(&[0x80; 16], GuestAddress(ALIGNED_ADDR)).unwrap(); mem.write_slice(&[0x80; 16], GuestAddress(ALIGNED_ADDR2)).unwrap(); run_until_hlt(&mut vcpu).unwrap(); }
#[test] fn test__pattern_4() { let code = [0x48, 0xb8]; let mut full_code = code.to_vec(); full_code.extend_from_slice(&ALIGNED_ADDR.to_le_bytes()); full_code.extend_from_slice(&[0x48, 0xbb]); full_code.extend_from_slice(&ALIGNED_ADDR2.to_le_bytes()); full_code.extend_from_slice(&[0x0f, 0x28, 0x00, 0x0f, 0x28, 0x0b, 0x0f, 0x54, 0xc1, 0xf4]); let (mut vcpu, mem) = setup_vm(&full_code, None); mem.write_slice(&[0x7F; 16], GuestAddress(ALIGNED_ADDR)).unwrap(); mem.write_slice(&[0x01; 16], GuestAddress(ALIGNED_ADDR2)).unwrap(); run_until_hlt(&mut vcpu).unwrap(); }
#[test] fn test__pattern_4() { let code = [0x48, 0xb8]; let mut full_code = code.to_vec(); full_code.extend_from_slice(&ALIGNED_ADDR.to_le_bytes()); full_code.extend_from_slice(&[0x48, 0xbb]); full_code.extend_from_slice(&ALIGNED_ADDR2.to_le_bytes()); full_code.extend_from_slice(&[0x66, 0x0f, 0x28, 0x00, 0x66, 0x0f, 0x28, 0x0b, 0x66, 0x0f, 0x54, 0xc1, 0xf4]); let (mut vcpu, mem) = setup_vm(&full_code, None); mem.write_slice(&[0x7F; 16], GuestAddress(ALIGNED_ADDR)).unwrap(); mem.write_slice(&[0x01; 16], GuestAddress(ALIGNED_ADDR2)).unwrap(); run_until_hlt(&mut vcpu).unwrap(); }
#[test] fn test__xmm4_xmm5() { let code = [0x48, 0xb8]; let mut full_code = code.to_vec(); full_code.extend_from_slice(&ALIGNED_ADDR.to_le_bytes()); full_code.extend_from_slice(&[0x48, 0xbb]); full_code.extend_from_slice(&ALIGNED_ADDR2.to_le_bytes()); full_code.extend_from_slice(&[0x0f, 0x28, 0x20, 0x0f, 0x28, 0x2b, 0x0f, 0x54, 0xe5, 0xf4]); let (mut vcpu, mem) = setup_vm(&full_code, None); mem.write_slice(&[0xC3; 16], GuestAddress(ALIGNED_ADDR)).unwrap(); mem.write_slice(&[0x3C; 16], GuestAddress(ALIGNED_ADDR2)).unwrap(); run_until_hlt(&mut vcpu).unwrap(); }
#[test] fn test__xmm4_xmm5() { let code = [0x48, 0xb8]; let mut full_code = code.to_vec(); full_code.extend_from_slice(&ALIGNED_ADDR.to_le_bytes()); full_code.extend_from_slice(&[0x48, 0xbb]); full_code.extend_from_slice(&ALIGNED_ADDR2.to_le_bytes()); full_code.extend_from_slice(&[0x66, 0x0f, 0x28, 0x20, 0x66, 0x0f, 0x28, 0x2b, 0x66, 0x0f, 0x54, 0xe5, 0xf4]); let (mut vcpu, mem) = setup_vm(&full_code, None); mem.write_slice(&[0xC3; 16], GuestAddress(ALIGNED_ADDR)).unwrap(); mem.write_slice(&[0x3C; 16], GuestAddress(ALIGNED_ADDR2)).unwrap(); run_until_hlt(&mut vcpu).unwrap(); }
#[test] fn test__pattern_1() { let code = [0x48, 0xb8]; let mut full_code = code.to_vec(); full_code.extend_from_slice(&ALIGNED_ADDR.to_le_bytes()); full_code.extend_from_slice(&[0x48, 0xbb]); full_code.extend_from_slice(&ALIGNED_ADDR2.to_le_bytes()); full_code.extend_from_slice(&[0x0f, 0x28, 0x00, 0x0f, 0x28, 0x0b, 0x0f, 0x54, 0xc1, 0xf4]); let (mut vcpu, mem) = setup_vm(&full_code, None); mem.write_slice(&[0x11, 0x22, 0x33, 0x44, 0x55, 0x66, 0x77, 0x88, 0x99, 0xAA, 0xBB, 0xCC, 0xDD, 0xEE, 0xFF, 0x00], GuestAddress(ALIGNED_ADDR)).unwrap(); mem.write_slice(&[0xFF, 0xEE, 0xDD, 0xCC, 0xBB, 0xAA, 0x99, 0x88, 0x77, 0x66, 0x55, 0x44, 0x33, 0x22, 0x11, 0x00], GuestAddress(ALIGNED_ADDR2)).unwrap(); run_until_hlt(&mut vcpu).unwrap(); }
#[test] fn test__pattern_1() { let code = [0x48, 0xb8]; let mut full_code = code.to_vec(); full_code.extend_from_slice(&ALIGNED_ADDR.to_le_bytes()); full_code.extend_from_slice(&[0x48, 0xbb]); full_code.extend_from_slice(&ALIGNED_ADDR2.to_le_bytes()); full_code.extend_from_slice(&[0x66, 0x0f, 0x28, 0x00, 0x66, 0x0f, 0x28, 0x0b, 0x66, 0x0f, 0x54, 0xc1, 0xf4]); let (mut vcpu, mem) = setup_vm(&full_code, None); mem.write_slice(&[0x11, 0x22, 0x33, 0x44, 0x55, 0x66, 0x77, 0x88, 0x99, 0xAA, 0xBB, 0xCC, 0xDD, 0xEE, 0xFF, 0x00], GuestAddress(ALIGNED_ADDR)).unwrap(); mem.write_slice(&[0xFF, 0xEE, 0xDD, 0xCC, 0xBB, 0xAA, 0x99, 0x88, 0x77, 0x66, 0x55, 0x44, 0x33, 0x22, 0x11, 0x00], GuestAddress(ALIGNED_ADDR2)).unwrap(); run_until_hlt(&mut vcpu).unwrap(); }
#[test] fn test__pattern_2() { let code = [0x48, 0xb8]; let mut full_code = code.to_vec(); full_code.extend_from_slice(&ALIGNED_ADDR.to_le_bytes()); full_code.extend_from_slice(&[0x48, 0xbb]); full_code.extend_from_slice(&ALIGNED_ADDR2.to_le_bytes()); full_code.extend_from_slice(&[0x0f, 0x28, 0x00, 0x0f, 0x28, 0x0b, 0x0f, 0x54, 0xc1, 0xf4]); let (mut vcpu, mem) = setup_vm(&full_code, None); mem.write_slice(&[0x01; 16], GuestAddress(ALIGNED_ADDR)).unwrap(); mem.write_slice(&[0x01; 16], GuestAddress(ALIGNED_ADDR2)).unwrap(); run_until_hlt(&mut vcpu).unwrap(); }
#[test] fn test__pattern_2() { let code = [0x48, 0xb8]; let mut full_code = code.to_vec(); full_code.extend_from_slice(&ALIGNED_ADDR.to_le_bytes()); full_code.extend_from_slice(&[0x48, 0xbb]); full_code.extend_from_slice(&ALIGNED_ADDR2.to_le_bytes()); full_code.extend_from_slice(&[0x66, 0x0f, 0x28, 0x00, 0x66, 0x0f, 0x28, 0x0b, 0x66, 0x0f, 0x54, 0xc1, 0xf4]); let (mut vcpu, mem) = setup_vm(&full_code, None); mem.write_slice(&[0x01; 16], GuestAddress(ALIGNED_ADDR)).unwrap(); mem.write_slice(&[0x01; 16], GuestAddress(ALIGNED_ADDR2)).unwrap(); run_until_hlt(&mut vcpu).unwrap(); }
#[test] fn test__pattern_3() { let code = [0x48, 0xb8]; let mut full_code = code.to_vec(); full_code.extend_from_slice(&ALIGNED_ADDR.to_le_bytes()); full_code.extend_from_slice(&[0x48, 0xbb]); full_code.extend_from_slice(&ALIGNED_ADDR2.to_le_bytes()); full_code.extend_from_slice(&[0x0f, 0x28, 0x00, 0x0f, 0x28, 0x0b, 0x0f, 0x54, 0xc1, 0xf4]); let (mut vcpu, mem) = setup_vm(&full_code, None); mem.write_slice(&[0x80; 16], GuestAddress(ALIGNED_ADDR)).unwrap(); mem.write_slice(&[0x80; 16], GuestAddress(ALIGNED_ADDR2)).unwrap(); run_until_hlt(&mut vcpu).unwrap(); }
#[test] fn test__pattern_3() { let code = [0x48, 0xb8]; let mut full_code = code.to_vec(); full_code.extend_from_slice(&ALIGNED_ADDR.to_le_bytes()); full_code.extend_from_slice(&[0x48, 0xbb]); full_code.extend_from_slice(&ALIGNED_ADDR2.to_le_bytes()); full_code.extend_from_slice(&[0x66, 0x0f, 0x28, 0x00, 0x66, 0x0f, 0x28, 0x0b, 0x66, 0x0f, 0x54, 0xc1, 0xf4]); let (mut vcpu, mem) = setup_vm(&full_code, None); mem.write_slice(&[0x80; 16], GuestAddress(ALIGNED_ADDR)).unwrap(); mem.write_slice(&[0x80; 16], GuestAddress(ALIGNED_ADDR2)).unwrap(); run_until_hlt(&mut vcpu).unwrap(); }
#[test] fn test__pattern_4() { let code = [0x48, 0xb8]; let mut full_code = code.to_vec(); full_code.extend_from_slice(&ALIGNED_ADDR.to_le_bytes()); full_code.extend_from_slice(&[0x48, 0xbb]); full_code.extend_from_slice(&ALIGNED_ADDR2.to_le_bytes()); full_code.extend_from_slice(&[0x0f, 0x28, 0x00, 0x0f, 0x28, 0x0b, 0x0f, 0x54, 0xc1, 0xf4]); let (mut vcpu, mem) = setup_vm(&full_code, None); mem.write_slice(&[0x7F; 16], GuestAddress(ALIGNED_ADDR)).unwrap(); mem.write_slice(&[0x01; 16], GuestAddress(ALIGNED_ADDR2)).unwrap(); run_until_hlt(&mut vcpu).unwrap(); }
#[test] fn test__pattern_4() { let code = [0x48, 0xb8]; let mut full_code = code.to_vec(); full_code.extend_from_slice(&ALIGNED_ADDR.to_le_bytes()); full_code.extend_from_slice(&[0x48, 0xbb]); full_code.extend_from_slice(&ALIGNED_ADDR2.to_le_bytes()); full_code.extend_from_slice(&[0x66, 0x0f, 0x28, 0x00, 0x66, 0x0f, 0x28, 0x0b, 0x66, 0x0f, 0x54, 0xc1, 0xf4]); let (mut vcpu, mem) = setup_vm(&full_code, None); mem.write_slice(&[0x7F; 16], GuestAddress(ALIGNED_ADDR)).unwrap(); mem.write_slice(&[0x01; 16], GuestAddress(ALIGNED_ADDR2)).unwrap(); run_until_hlt(&mut vcpu).unwrap(); }
#[test] fn test__xmm4_xmm5() { let code = [0x48, 0xb8]; let mut full_code = code.to_vec(); full_code.extend_from_slice(&ALIGNED_ADDR.to_le_bytes()); full_code.extend_from_slice(&[0x48, 0xbb]); full_code.extend_from_slice(&ALIGNED_ADDR2.to_le_bytes()); full_code.extend_from_slice(&[0x0f, 0x28, 0x20, 0x0f, 0x28, 0x2b, 0x0f, 0x54, 0xe5, 0xf4]); let (mut vcpu, mem) = setup_vm(&full_code, None); mem.write_slice(&[0xC3; 16], GuestAddress(ALIGNED_ADDR)).unwrap(); mem.write_slice(&[0x3C; 16], GuestAddress(ALIGNED_ADDR2)).unwrap(); run_until_hlt(&mut vcpu).unwrap(); }
#[test] fn test__xmm4_xmm5() { let code = [0x48, 0xb8]; let mut full_code = code.to_vec(); full_code.extend_from_slice(&ALIGNED_ADDR.to_le_bytes()); full_code.extend_from_slice(&[0x48, 0xbb]); full_code.extend_from_slice(&ALIGNED_ADDR2.to_le_bytes()); full_code.extend_from_slice(&[0x66, 0x0f, 0x28, 0x20, 0x66, 0x0f, 0x28, 0x2b, 0x66, 0x0f, 0x54, 0xe5, 0xf4]); let (mut vcpu, mem) = setup_vm(&full_code, None); mem.write_slice(&[0xC3; 16], GuestAddress(ALIGNED_ADDR)).unwrap(); mem.write_slice(&[0x3C; 16], GuestAddress(ALIGNED_ADDR2)).unwrap(); run_until_hlt(&mut vcpu).unwrap(); }
#[test] fn test__pattern_1() { let code = [0x48, 0xb8]; let mut full_code = code.to_vec(); full_code.extend_from_slice(&ALIGNED_ADDR.to_le_bytes()); full_code.extend_from_slice(&[0x48, 0xbb]); full_code.extend_from_slice(&ALIGNED_ADDR2.to_le_bytes()); full_code.extend_from_slice(&[0x0f, 0x28, 0x00, 0x0f, 0x28, 0x0b, 0x0f, 0x54, 0xc1, 0xf4]); let (mut vcpu, mem) = setup_vm(&full_code, None); mem.write_slice(&[0x11, 0x22, 0x33, 0x44, 0x55, 0x66, 0x77, 0x88, 0x99, 0xAA, 0xBB, 0xCC, 0xDD, 0xEE, 0xFF, 0x00], GuestAddress(ALIGNED_ADDR)).unwrap(); mem.write_slice(&[0xFF, 0xEE, 0xDD, 0xCC, 0xBB, 0xAA, 0x99, 0x88, 0x77, 0x66, 0x55, 0x44, 0x33, 0x22, 0x11, 0x00], GuestAddress(ALIGNED_ADDR2)).unwrap(); run_until_hlt(&mut vcpu).unwrap(); }
#[test] fn test__pattern_1() { let code = [0x48, 0xb8]; let mut full_code = code.to_vec(); full_code.extend_from_slice(&ALIGNED_ADDR.to_le_bytes()); full_code.extend_from_slice(&[0x48, 0xbb]); full_code.extend_from_slice(&ALIGNED_ADDR2.to_le_bytes()); full_code.extend_from_slice(&[0x66, 0x0f, 0x28, 0x00, 0x66, 0x0f, 0x28, 0x0b, 0x66, 0x0f, 0x54, 0xc1, 0xf4]); let (mut vcpu, mem) = setup_vm(&full_code, None); mem.write_slice(&[0x11, 0x22, 0x33, 0x44, 0x55, 0x66, 0x77, 0x88, 0x99, 0xAA, 0xBB, 0xCC, 0xDD, 0xEE, 0xFF, 0x00], GuestAddress(ALIGNED_ADDR)).unwrap(); mem.write_slice(&[0xFF, 0xEE, 0xDD, 0xCC, 0xBB, 0xAA, 0x99, 0x88, 0x77, 0x66, 0x55, 0x44, 0x33, 0x22, 0x11, 0x00], GuestAddress(ALIGNED_ADDR2)).unwrap(); run_until_hlt(&mut vcpu).unwrap(); }
#[test] fn test__pattern_2() { let code = [0x48, 0xb8]; let mut full_code = code.to_vec(); full_code.extend_from_slice(&ALIGNED_ADDR.to_le_bytes()); full_code.extend_from_slice(&[0x48, 0xbb]); full_code.extend_from_slice(&ALIGNED_ADDR2.to_le_bytes()); full_code.extend_from_slice(&[0x0f, 0x28, 0x00, 0x0f, 0x28, 0x0b, 0x0f, 0x54, 0xc1, 0xf4]); let (mut vcpu, mem) = setup_vm(&full_code, None); mem.write_slice(&[0x01; 16], GuestAddress(ALIGNED_ADDR)).unwrap(); mem.write_slice(&[0x01; 16], GuestAddress(ALIGNED_ADDR2)).unwrap(); run_until_hlt(&mut vcpu).unwrap(); }
#[test] fn test__pattern_2() { let code = [0x48, 0xb8]; let mut full_code = code.to_vec(); full_code.extend_from_slice(&ALIGNED_ADDR.to_le_bytes()); full_code.extend_from_slice(&[0x48, 0xbb]); full_code.extend_from_slice(&ALIGNED_ADDR2.to_le_bytes()); full_code.extend_from_slice(&[0x66, 0x0f, 0x28, 0x00, 0x66, 0x0f, 0x28, 0x0b, 0x66, 0x0f, 0x54, 0xc1, 0xf4]); let (mut vcpu, mem) = setup_vm(&full_code, None); mem.write_slice(&[0x01; 16], GuestAddress(ALIGNED_ADDR)).unwrap(); mem.write_slice(&[0x01; 16], GuestAddress(ALIGNED_ADDR2)).unwrap(); run_until_hlt(&mut vcpu).unwrap(); }
#[test] fn test__pattern_3() { let code = [0x48, 0xb8]; let mut full_code = code.to_vec(); full_code.extend_from_slice(&ALIGNED_ADDR.to_le_bytes()); full_code.extend_from_slice(&[0x48, 0xbb]); full_code.extend_from_slice(&ALIGNED_ADDR2.to_le_bytes()); full_code.extend_from_slice(&[0x0f, 0x28, 0x00, 0x0f, 0x28, 0x0b, 0x0f, 0x54, 0xc1, 0xf4]); let (mut vcpu, mem) = setup_vm(&full_code, None); mem.write_slice(&[0x80; 16], GuestAddress(ALIGNED_ADDR)).unwrap(); mem.write_slice(&[0x80; 16], GuestAddress(ALIGNED_ADDR2)).unwrap(); run_until_hlt(&mut vcpu).unwrap(); }
#[test] fn test__pattern_3() { let code = [0x48, 0xb8]; let mut full_code = code.to_vec(); full_code.extend_from_slice(&ALIGNED_ADDR.to_le_bytes()); full_code.extend_from_slice(&[0x48, 0xbb]); full_code.extend_from_slice(&ALIGNED_ADDR2.to_le_bytes()); full_code.extend_from_slice(&[0x66, 0x0f, 0x28, 0x00, 0x66, 0x0f, 0x28, 0x0b, 0x66, 0x0f, 0x54, 0xc1, 0xf4]); let (mut vcpu, mem) = setup_vm(&full_code, None); mem.write_slice(&[0x80; 16], GuestAddress(ALIGNED_ADDR)).unwrap(); mem.write_slice(&[0x80; 16], GuestAddress(ALIGNED_ADDR2)).unwrap(); run_until_hlt(&mut vcpu).unwrap(); }
#[test] fn test__pattern_4() { let code = [0x48, 0xb8]; let mut full_code = code.to_vec(); full_code.extend_from_slice(&ALIGNED_ADDR.to_le_bytes()); full_code.extend_from_slice(&[0x48, 0xbb]); full_code.extend_from_slice(&ALIGNED_ADDR2.to_le_bytes()); full_code.extend_from_slice(&[0x0f, 0x28, 0x00, 0x0f, 0x28, 0x0b, 0x0f, 0x54, 0xc1, 0xf4]); let (mut vcpu, mem) = setup_vm(&full_code, None); mem.write_slice(&[0x7F; 16], GuestAddress(ALIGNED_ADDR)).unwrap(); mem.write_slice(&[0x01; 16], GuestAddress(ALIGNED_ADDR2)).unwrap(); run_until_hlt(&mut vcpu).unwrap(); }
#[test] fn test__pattern_4() { let code = [0x48, 0xb8]; let mut full_code = code.to_vec(); full_code.extend_from_slice(&ALIGNED_ADDR.to_le_bytes()); full_code.extend_from_slice(&[0x48, 0xbb]); full_code.extend_from_slice(&ALIGNED_ADDR2.to_le_bytes()); full_code.extend_from_slice(&[0x66, 0x0f, 0x28, 0x00, 0x66, 0x0f, 0x28, 0x0b, 0x66, 0x0f, 0x54, 0xc1, 0xf4]); let (mut vcpu, mem) = setup_vm(&full_code, None); mem.write_slice(&[0x7F; 16], GuestAddress(ALIGNED_ADDR)).unwrap(); mem.write_slice(&[0x01; 16], GuestAddress(ALIGNED_ADDR2)).unwrap(); run_until_hlt(&mut vcpu).unwrap(); }
#[test] fn test__xmm4_xmm5() { let code = [0x48, 0xb8]; let mut full_code = code.to_vec(); full_code.extend_from_slice(&ALIGNED_ADDR.to_le_bytes()); full_code.extend_from_slice(&[0x48, 0xbb]); full_code.extend_from_slice(&ALIGNED_ADDR2.to_le_bytes()); full_code.extend_from_slice(&[0x0f, 0x28, 0x20, 0x0f, 0x28, 0x2b, 0x0f, 0x54, 0xe5, 0xf4]); let (mut vcpu, mem) = setup_vm(&full_code, None); mem.write_slice(&[0xC3; 16], GuestAddress(ALIGNED_ADDR)).unwrap(); mem.write_slice(&[0x3C; 16], GuestAddress(ALIGNED_ADDR2)).unwrap(); run_until_hlt(&mut vcpu).unwrap(); }
#[test] fn test__xmm4_xmm5() { let code = [0x48, 0xb8]; let mut full_code = code.to_vec(); full_code.extend_from_slice(&ALIGNED_ADDR.to_le_bytes()); full_code.extend_from_slice(&[0x48, 0xbb]); full_code.extend_from_slice(&ALIGNED_ADDR2.to_le_bytes()); full_code.extend_from_slice(&[0x66, 0x0f, 0x28, 0x20, 0x66, 0x0f, 0x28, 0x2b, 0x66, 0x0f, 0x54, 0xe5, 0xf4]); let (mut vcpu, mem) = setup_vm(&full_code, None); mem.write_slice(&[0xC3; 16], GuestAddress(ALIGNED_ADDR)).unwrap(); mem.write_slice(&[0x3C; 16], GuestAddress(ALIGNED_ADDR2)).unwrap(); run_until_hlt(&mut vcpu).unwrap(); }
